<html>

<style>

    canvas {
        padding: 0;
        margin: auto;
    	position: absolute;
    	top: 10px;
    	left: 100px;
        background-image: url("art_icons/transparency.png");
        background-repeat: round;
        border:5px solid rgb(150,150,150);
    }
    .cset {
        top: 30px;
        left: 30px;
        width: auto;
        height: auto;
    }
    .slider {
        width: 85%;
    }
    hr {
        width: 90%;
    }
    .sidebar {
        position: absolute;
        top: 10px;
        right: 10px;
        height: auto;
        width: auto;
        background-color: rgb(175,175,175);
        border: 5px solid rgb(150,150,150);
    }
    body {
        background-color: rgb(100,100,100)
    }
    button {
        cursor: pointer;
    }    
    .brAll {
        background-color: rgb(150,150,150); 
        border: 3px solid #afafaf;
        width: 38px;
        height: 38px;
    }
    .br0 {
        background-image: url("art_icons/square.png");
    }
    .br1 {
        background-image: url("art_icons/circle.png");
    }
    .br2 {
        background-image: url("art_icons/e_square.png");
    }
    .br3 {
        background-image: url("art_icons/e_circle.png");
    }
    
</style>
	
<head>
    <title>Art</title>
</head>
    
<body onmousemove="getCoords(event)">

<div class="cset">
    <label>Width:</label>
    <input type="number" step="1" value="960" id="setWidth">
    <br>
    <label>Height:</label>
    <input type="number" step="1" value="540" id="setHeight">
    <br>
    <button onmousedown="start()">Ready!</button>
</div>
    
<div class="sidebar">

    <table align="center" style="padding:5px 0px 0px;">
        <tr>
            <th colspan="6"><button onmousedown="clearCanvas()">Clear Canvas</button></th>
        </tr>
    </table>
    <hr>
    <table align="center">
        <tr>
            <th><label>Brush Color</label></th>
        </tr>
        <tr>
            <th><input type="color" id="colorSelect"></th>
        </tr>
    </table>
    
    <hr>
    
    <table align="center">
        <tr>
            <th><label>Brush Size: <span id="sizeTxt"></span></label></th>
        </tr>
        <tr>
            <th><input type="range" min="1" max="100" value="20" step="1" id="brushRange" class="slider"></th>
        </tr>
    </table>
    
    <hr>
    
    <table align="center">
        <tr>
            <th colspan="2"><label>Brush Type</label></th>
        </tr>
        <tr>
            <th><button onmousedown="brushChange(0)" id="br0" class="brAll br0"></button></th>
            <th><button onmousedown="brushChange(1)" id="br1" class="brAll br1"></button></th>
        </tr>
        <tr>
            <th><button onmousedown="brushChange(2)" id="br2" class="brAll br2"></button></th>
            <th><button onmousedown="brushChange(3)" id="br3" class="brAll br3"></button></th>
        </tr>
    </table>

    <hr>
    
    <table align="center" style="padding:0px 0px 5px;">
        <tr>
            <th><button>Save Image</button></th>
        </tr>
        <tr>
            <th><p style="font-size: 12px;"><i>(Doesn't work yet)</i></p></th>
    </table>
    
</div>

<script>
	
    var brush;
    var draw = false;
    var mouseX;
    var mouseY;
    var runSpeed = 1;
    var canvasWidth = 960;
    var canvasHeight = 540;
    var brushSize = 20;
    var brushColor = 23;
    var brushType = 1;
    var brushColor = "rgb(0, 0, 0)";
    window.addEventListener('mousedown', function() {
        draw = true;
    });
    
    window.addEventListener('mouseup', function() {
        draw = false;
    });
    
    function start() {
        
        brush = new component(brushSize, brushSize, "rgb(0,0,0)", -brushSize, -brushSize);
        area.start();
        document.getElementById("br1").style.border = "3px solid #42a9f7";
        document.getElementById("br1").style.cursor = "default";
        var area = {
            canvas : document.createElement("canvas"),
            start : function() {
                this.canvas.width = canvasWidth;
                this.canvas.height = canvasHeight;
                this.context = this.canvas.getContext("2d");
                document.body.insertBefore(this.canvas, document.body.childNodes[0]);
                this.interval = setInterval(updateArea, runSpeed);
        },
            clear : function() {
                this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }
        }
    }
    
    
    function component(width, height, color, x, y) {
        this.width = width;
        this.height = height;
        this.x = x;
        this.y = y;    
        this.update = function() {
            ctx = area.context;
            ctx.fillStyle = brushColor;
            
            if (brushType == 0) {
                ctx.fillRect(this.x, this.y, this.width, this.height);
            } else if (brushType == 1) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, (this.width * 0.5), 0, 2 * Math.PI);
                ctx.fill();
            } else if (brushType == 2) {
                ctx.clearRect(this.x, this.y, this.width, this.height)   
            } else {
                ctx.globalCompositeOperation = 'destination-out'
                ctx.beginPath();
                ctx.arc(this.x, this.y, (this.width * 0.5), 0, 2 * Math.PI);
                ctx.fill();
                ctx.globalCompositeOperation = 'source-over'
            }
    	}
    	this.updatePos = function() {
            if (draw) {
                this.x = mouseX;
                this.y = mouseY;
            }
    	}    
    }
    
    function updateArea() {
    	brush.updatePos();    
    	brush.update();
    }
	
    function getCoords(event) {
        if (brushType == 0) {
            mouseX = event.clientX - 105 - (brushSize * 0.5);
            mouseY = event.clientY - 15 - (brushSize * 0.5);
        } else if (brushType == 1) {
            mouseX = event.clientX - 105;
            mouseY = event.clientY - 15;
        } else if (brushType == 2) {
            mouseX = event.clientX - 105 - (brushSize * 0.5);
            mouseY = event.clientY - 15 - (brushSize * 0.5);
        } else {
            mouseX = event.clientX - 105;
            mouseY = event.clientY - 15;
        }
    }
    
    function colorSelect(n) {
        brushColor = n;
    }
    
    function brushChange(n) {
        brushType = n;
        if (n == 0) {
            document.getElementById("br0").style.border = "3px solid #42a9f7";
            document.getElementById("br0").style.cursor = "default";
            
            document.getElementById("br1").style.border = "";
            document.getElementById("br2").style.border = "";
            document.getElementById("br3").style.border = "";
            document.getElementById("br1").style.cursor = "";
            document.getElementById("br2").style.cursor = "";
            document.getElementById("br3").style.cursor = "";
        } else if (n == 1) {
            document.getElementById("br1").style.border = "3px solid #42a9f7";
            document.getElementById("br1").style.cursor = "default";
            
            document.getElementById("br0").style.border = "";
            document.getElementById("br2").style.border = "";
            document.getElementById("br3").style.border = "";
            document.getElementById("br0").style.cursor = "";
            document.getElementById("br2").style.cursor = "";
            document.getElementById("br3").style.cursor = "";
        } else if (n == 2) {
            document.getElementById("br2").style.border = "3px solid #42a9f7";
            document.getElementById("br2").style.cursor = "default";
            
            document.getElementById("br0").style.border = "";
            document.getElementById("br1").style.border = "";
            document.getElementById("br3").style.border = "";
            document.getElementById("br0").style.cursor = "";
            document.getElementById("br1").style.cursor = "";
            document.getElementById("br3").style.cursor = "";
        } else {
            document.getElementById("br3").style.border = "3px solid #42a9f7";
            document.getElementById("br3").style.cursor = "default";
            
            document.getElementById("br0").style.border = "";
            document.getElementById("br1").style.border = "";
            document.getElementById("br2").style.border = "";
            document.getElementById("br0").style.cursor = "";
            document.getElementById("br1").style.cursor = "";
            document.getElementById("br2").style.cursor = "";
        }
    }
    
    function clearCanvas() {
        var check = confirm("Are you sure?");
        if (check) {
            area.clear();
            brushChange(3);
        }
    }
	
    var sizeSlider = document.getElementById("brushRange");
    var sizeIndicator = document.getElementById("sizeTxt");
    sizeIndicator.innerHTML = sizeSlider.value;
    sizeSlider.oninput = function() {
        sizeIndicator.innerHTML = this.value;
        brushSize = this.value;
        brush = new component(brushSize, brushSize, "rgb(0,0,0)", -brushSize, -brushSize)
    }
    
    
    var colorPicker = document.getElementById("colorSelect");
    colorPicker.oninput = function() {
        brushColor = this.value;
    }
    
    var wSet = document.getElementById("setWidth");
    var hSet = document.getElementById("setHeight");
    wSet.oninput = function() {
        canvasWidth = this.value;
    }
    hSet.oninput = function() {
        canvasHeight = this.value;
    }
        
</script>

</body>

</html>
